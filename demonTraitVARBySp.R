#TRYtraitIDs <- unique(TRYdata$TraitID)

TraitVARBySp <- function(data, X = 'TraitID', Y = 'AccSpeciesName', Z = 'StdValue'){
  #traitID <- c(1,11,3106,3107,3108,3109,3110,3111,3114,3115,3116,3117)
  traitID <- c(1, 11, 3106, 3107, 3108, 3109, 3110, 3111, 3114, 3115, 3116, 3117,
               2, 3, 4, 6, 7,8, 12, 13, 14, 15, 16, 17, 21, 22, 24, 26, 27, 28, 29, 
               30, 31, 33, 34, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 
               50, 51, 53, 54, 56, 57, 59, 61, 62, 63, 65, 66, 70, 77, 78, 79, 80, 
               89, 95, 96, 97, 98, 99, 110, 125, 128, 131, 138, 140, 143, 144, 146, 
               149, 152, 153, 154, 155, 159, 163, 169, 170, 172, 185, 186, 196, 197, 
               199, 200, 201, 204, 205, 206, 207, 208, 211, 212, 213, 215, 218, 221, 
               222, 223, 224, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 
               238, 239, 242, 244, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 
               259, 260, 262, 265, 268, 273, 275, 276, 277, 278, 279, 280, 281, 282, 
               283, 285, 286, 287, 288, 289, 290, 291, 292, 293, 295, 296, 297, 299, 
               304, 310, 318, 320, 324, 325, 329, 333, 334, 335, 336, 341, 343, 344, 
               345, 346, 347, 349, 350, 351, 353, 357, 358, 361, 403, 409, 413, 419, 
               420, 539, 540, 542, 543, 547, 548, 551, 570, 575, 581, 582, 583, 585, 
               586, 587, 593, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 
               609, 610, 611, 613, 614, 677, 679, 719, 759, 781, 784, 788, 813, 814, 
               815, 816, 817, 819, 822, 823, 825, 826, 827, 831, 834, 835, 836, 837, 
               838, 865, 892, 893, 894, 915, 928, 929, 931, 936, 937, 938, 939, 940, 
               963, 965, 967, 975, 979, 980, 1008, 1016, 1029, 1030, 1093, 1096, 1103, 
               1104, 1105, 1108, 1111, 1118, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 
               1137, 1138, 1139, 1140, 1141, 1142, 1145, 1146,1176, 1182, 1184, 1187, 
               1188, 1189, 1194, 1200, 1205, 1206, 1210, 1211, 1216, 1220, 1221, 1234, 
               1236, 1237, 1238, 1239, 1240, 1251, 1254, 1255, 1256, 1263, 2807, 2808, 
               2809, 2813, 2818,  2819, 2820, 2934, 2935, 2936, 2937, 2938, 2939, 2940, 
               2941, 2942, 2943, 3018, 3019, 3020, 3021, 3026, 3096, 3097, 3098)
  df <- data.frame(X = data[, X], Y = data[, Y], Z = data[, Z])
  sub.df <- df[df$X%in%traitID, ]
  unique(paste(sub.df$Y))
  sub.df$Z <- as.numeric(sub.df$Z)
  .f <- function(new)aggregate(Z~Y+X, data = new, FUN = 'var', na.rm = T)
  M <- .f(sub.df)
  Cols <- paste(unique(M$X))
  Rows <- paste(unique(M$Y))
  m <- matrix( , nrow = length(Rows), ncol = length(Cols), dimnames = list(Rows, Cols))
  for(Col in Cols){
    for(Row in Rows)if(sum(M$Y == Row&M$X == Col)!=0)m[Rows == Row, Cols == Col] <- M$Z[M$Y == Row&M$X == Col]
  }
  colnames(m) <- Cols
  rownames(m) <- Rows
  m
}
